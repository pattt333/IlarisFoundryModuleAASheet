{{!-- Item Component Partial
     Displays an expandable item with name, image, and contextual action buttons
     Usage: {{> item-component item=item}}
--}}
<li class="item item-component flexrow" data-item-id="{{item._id}}" data-item-type="{{item.type}}">
    <div class="item-header flexrow" data-action="toggle-item">
        <div class="item-name">
            <div class="item-image">
                <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
            </div>
            <h4>{{item.name}}</h4>
        </div>
        
        <div class="item-actions">
            {{!-- Combat button for weapons --}}
            {{#if (or (eq item.type "nahkampfwaffe") (eq item.type "fernkampfwaffe"))}}
                <a class="item-action combat-dialog" title="Open Combat Dialog" data-action="combat-dialog">
                    <i class="fas fa-sword"></i>
                </a>
            {{/if}}
            
            {{!-- Profane button for skills --}}
            {{#if (or (eq item.type "fertigkeit") (eq item.type "freie_fertigkeit") (eq item.type "uebernatuerliche_fertigkeit"))}}
                <a class="item-action profane-dialog" title="Open Profane Dialog" data-action="profane-dialog">
                    <i class="fas fa-magic"></i>
                </a>
            {{/if}}
            
            {{!-- Expand/Collapse toggle --}}
            <a class="item-action toggle-expand" title="Expand/Collapse" data-action="toggle-expand">
                <i class="fas fa-chevron-down expand-icon"></i>
            </a>
        </div>
        
        <div class="item-controls">
            <a class="item-control item-edit" title="Edit Item">
                <i class="fas fa-edit"></i>
            </a>
            <a class="item-control item-delete" title="Delete Item">
                <i class="fas fa-trash"></i>
            </a>
        </div>
    </div>
    
    {{!-- Expandable content area --}}
    <div class="item-details" style="display: none;">
        <div class="item-details-content">
            {{!-- Description --}}
            {{#if item.system.description}}
                <div class="detail-section">
                    <label>Description:</label>
                    <div class="detail-value">{{item.system.description}}</div>
                </div>
            {{/if}}
            
            {{!-- Weapon-specific properties --}}
            {{#if (or (eq item.type "nahkampfwaffe") (eq item.type "fernkampfwaffe"))}}
                {{#if item.system.damage}}
                    <div class="detail-section">
                        <label>Damage:</label>
                        <div class="detail-value">{{item.system.damage}}</div>
                    </div>
                {{/if}}
                {{#if item.system.range}}
                    <div class="detail-section">
                        <label>Range:</label>
                        <div class="detail-value">{{item.system.range}}</div>
                    </div>
                {{/if}}
                {{#if item.system.properties}}
                    <div class="detail-section">
                        <label>Properties:</label>
                        <div class="detail-value">{{item.system.properties}}</div>
                    </div>
                {{/if}}
            {{/if}}
            
            {{!-- Skill-specific properties --}}
            {{#if (or (eq item.type "fertigkeit") (eq item.type "freie_fertigkeit") (eq item.type "uebernatuerliche_fertigkeit"))}}
                {{#if item.system.attribute}}
                    <div class="detail-section">
                        <label>Attribute:</label>
                        <div class="detail-value">{{item.system.attribute}}</div>
                    </div>
                {{/if}}
                {{#if item.system.value}}
                    <div class="detail-section">
                        <label>Value:</label>
                        <div class="detail-value">{{item.system.value}}</div>
                    </div>
                {{/if}}
            {{/if}}
            
            {{!-- Talent properties --}}
            {{#if (eq item.type "talent")}}
                {{#if item.system.requirements}}
                    <div class="detail-section">
                        <label>Requirements:</label>
                        <div class="detail-value">{{item.system.requirements}}</div>
                    </div>
                {{/if}}
                {{#if item.system.effects}}
                    <div class="detail-section">
                        <label>Effects:</label>
                        <div class="detail-value">{{item.system.effects}}</div>
                    </div>
                {{/if}}
            {{/if}}
            
            {{!-- Spell properties --}}
            {{#if (eq item.type "zauber")}}
                {{#if item.system.castingTime}}
                    <div class="detail-section">
                        <label>Casting Time:</label>
                        <div class="detail-value">{{item.system.castingTime}}</div>
                    </div>
                {{/if}}
                {{#if item.system.range}}
                    <div class="detail-section">
                        <label>Range:</label>
                        <div class="detail-value">{{item.system.range}}</div>
                    </div>
                {{/if}}
                {{#if item.system.duration}}
                    <div class="detail-section">
                        <label>Duration:</label>
                        <div class="detail-value">{{item.system.duration}}</div>
                    </div>
                {{/if}}
            {{/if}}
            
            {{!-- Equipment/Item properties --}}
            {{#if (eq item.type "gegenstand")}}
                {{#if item.system.weight}}
                    <div class="detail-section">
                        <label>Weight:</label>
                        <div class="detail-value">{{item.system.weight}}</div>
                    </div>
                {{/if}}
                {{#if item.system.value}}
                    <div class="detail-section">
                        <label>Value:</label>
                        <div class="detail-value">{{item.system.value}}</div>
                    </div>
                {{/if}}
            {{/if}}
            
            {{!-- Generic notes/details --}}
            {{#if item.system.notes}}
                <div class="detail-section">
                    <label>Notes:</label>
                    <div class="detail-value">{{item.system.notes}}</div>
                </div>
            {{/if}}
        </div>
    </div>
</li>